<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Texto</title>
    <!-- Cargamos Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Usamos la fuente Inter como se recomienda */
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- Corregido a max-w-7xl (con 'l' en lugar de '1') para un ancho máximo válido de Tailwind -->
    <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-7xl">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">Generador de Descripciones</h1>

        <!-- Desplegable de Constitución -->
        <div class="mb-6">
            <label for="constitucion" class="block text-lg font-semibold text-gray-700 mb-2">
                Constitución Corporal
            </label>
            <select id="constitucion" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white">
                <option value="" selected disabled>Selecciona una...</option>
                <option value="Delgada (fitness)">1: Delgada (fitness)</option>
                <option value="Delgada (musculosa)">2: Delgada (musculosa)</option>
                <option value="Delgada (anoréxica)">3: Delgada (anoréxica)</option>
                <option value="Rellenita">4: Rellenita</option>
                <option value="Gordita">5: Gordita</option>
                <option value="Caderas Anchas">6: Caderas Anchas</option>
            </select>
        </div>

        <!-- NUEVO: Desplegable de Pechos -->
        <div class="mb-6">
            <label for="pechos" class="block text-lg font-semibold text-gray-700 mb-2">
                Pechos
            </label>
            <select id="pechos" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white">
                <option value="" selected disabled>Selecciona una...</option>
                <option value="Pechos medianos">1: Pechos medianos</option>
                <option value="Pechos muy muy pequeños y planos">2: Pechos muy muy pequeños y planos</option>
                <option value="Pechos grandes y juntos">3: Pechos grandes y juntos</option>
                <option value="Pechos muy muy grandes">4: Pechos muy muy grandes</option>
            </select>
        </div>

        <!-- Área de Texto -->
        <div class="mb-6">
            <label for="descripcion" class="block text-lg font-semibold text-gray-700 mb-2">
                Descripción de la persona
            </label>
            <textarea
                id="descripcion"
                rows="6"
                class="w-full p-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                placeholder="Escribe aquí los detalles..."
            ></textarea>
        </div>

        <!-- Opciones de Radio -->
        <div class="mb-8">
            <!-- Título del grupo cambiado a "BASE" -->
            <label class="block text-lg font-semibold text-gray-700 mb-3">BASE</label>
            <div class="space-y-3">
                <!-- Opción BASE eliminada -->
                
                <!-- Opción 1 (ahora marcada por defecto) -->
                <!-- El atributo 'title' se rellenará con JavaScript -->
                <label for="opt-1" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer">
                    <input type="radio" id="opt-1" name="base_option" value="1" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300" checked>
                    <span class="ml-3 text-md font-medium text-gray-800">Base 1</span>
                </label>

                <!-- Opción 2 -->
                <label for="opt-2" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer">
                    <input type="radio" id="opt-2" name="base_option" value="2" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300">
                    <span class="ml-3 text-md font-medium text-gray-800">Base 2</span>
                </label>

                <!-- Opción 3 -->
                <label for="opt-3" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer">
                    <input type="radio" id="opt-3" name="base_option" value="3" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300">
                    <span class="ml-3 text-md font-medium text-gray-800">Base 3</span>
                </label>
            </div>
        </div>

        <!-- Botón de Generar -->
        <button id="generarBtn" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:bg-blue-700 transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
            Generar y Copiar
        </button>

        <!-- Mensaje de confirmación (en lugar de alert) -->
        <div id="messageBox" class="mt-6 p-4 bg-green-100 text-green-800 rounded-lg text-center font-medium hidden transition-all duration-300">
            ¡Texto copiado al portapapeles!
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const descripcionEl = document.getElementById('descripcion');
            const constitucionEl = document.getElementById('constitucion');
            const pechosEl = document.getElementById('pechos'); // <-- NUEVO: Elemento Pechos
            const generarBtn = document.getElementById('generarBtn');
            const messageBox = document.getElementById('messageBox');

            // Objeto para almacenar el contenido de los archivos
            const fileContents = {};

            // --- INICIO DE CARGA DE TOOLTIPS ---
            // Función para cargar los tooltips y preparar el contenido
            async function loadTooltipsAndContent() {
                const options = [
                    { value: '1', labelFor: 'opt-1' },
                    { value: '2', labelFor: 'opt-2' },
                    { value: '3', labelFor: 'opt-3' }
                ];

                // Usamos Promise.all para cargar todos los archivos en paralelo
                await Promise.all(options.map(async (opt) => {
                    const fileName = `${opt.value}.txt`;
                    // Buscamos la etiqueta <label> por su atributo 'for'
                    const label = document.querySelector(`label[for="${opt.labelFor}"]`);
                    
                    try {
                        const response = await fetch(fileName);
                        if (!response.ok) {
                            throw new Error(`Estado: ${response.status}`);
                        }
                        const text = await response.text();
                        
                        // Almacenar contenido para el botón de generar
                        fileContents[opt.value] = text; 
                        
                        // Asignar al tooltip (title attribute) de la etiqueta
                        if (label) {
                            label.title = text;
                        }
                        
                    } catch (err) {
                        console.error(`Error al cargar ${fileName}: ${err.message}`);
                        if (label) {
                            label.title = `Error al cargar el contenido de ${fileName}`;
                        }
                        // Guardamos un texto de error para que el botón lo muestre si se selecciona
                        fileContents[opt.value] = `[Error al cargar ${fileName}]`; 
                    }
                }));
            }
            // --- FIN DE CARGA DE TOOLTIPS ---

            // --- Event listener para el desplegable Constitución ---
            constitucionEl.addEventListener('change', () => {
                const selectedText = constitucionEl.value;
                if (selectedText) { // Nos aseguramos de que no sea la opción "Selecciona una..."
                    // Añade al textarea, sin sobrescribir
                    descripcionEl.value += `Constitución corporal ${selectedText}. `;
                }
            });

            // --- NUEVO: Event listener para el desplegable Pechos ---
            pechosEl.addEventListener('change', () => {
                const selectedText = pechosEl.value;
                if (selectedText) { // Nos aseguramos de que no sea la opción "Selecciona una..."
                    // Añade al textarea, sin sobrescribir
                    descripcionEl.value += `Tiene ${selectedText}. `;
                }
            });

            // Función para copiar al portapapeles (sin cambios)
            function copyToClipboard(text) {
                // Usamos el método 'execCommand' que es más fiable en entornos de iframe
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = text;
                tempTextarea.style.position = 'absolute';
                tempTextarea.style.left = '-9999px'; // Ocultarlo
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                try {
                    document.execCommand('copy');
                    // Mostrar mensaje de éxito
                    messageBox.textContent = '¡Texto combinado copiado al portapapeles!';
                    messageBox.classList.remove('hidden');
                    messageBox.classList.remove('bg-red-100', 'text-red-800');
                    messageBox.classList.add('bg-green-100', 'text-green-800');
                } catch (err) {
                    console.error('Error al copiar al portapapeles: ', err);
                    // Mostrar mensaje de error
                    messageBox.textContent = 'Error al copiar. Revisa la consola.';
                    messageBox.classList.remove('hidden');
                    messageBox.classList.remove('bg-green-100', 'text-green-800');
                    messageBox.classList.add('bg-red-100', 'text-red-800');
                }
                document.body.removeChild(tempTextarea);

                // Ocultar el mensaje después de 3 segundos
                setTimeout(() => {
                    messageBox.classList.add('hidden');
                }, 3000);
            }

            // Evento click del botón (MODIFICADO)
            generarBtn.addEventListener('click', () => { // <-- Eliminado 'async'
                // 1. Obtener la opción seleccionada
                const selectedOption = document.querySelector('input[name="base_option"]:checked');
                if (!selectedOption) {
                    // Mostrar error si nada está seleccionado (aunque 'Opción 1' está por defecto)
                    messageBox.textContent = 'Por favor, selecciona una opción.';
                    messageBox.classList.remove('hidden');
                    messageBox.classList.add('bg-red-100', 'text-red-800');
                    setTimeout(() => { messageBox.classList.add('hidden'); }, 3000);
                    return;
                }
                
                const selectedValue = selectedOption.value;

                // --- LÓGICA FETCH ELIMINADA DE AQUÍ ---
                // Ya no hay estado de 'Cargando...'
                
                // 2. Obtener el contenido base (desde el objeto pre-cargado)
                // Añadimos un espacio al final si el contenido existe
                const baseContent = fileContents[selectedValue] ? fileContents[selectedValue] + " " : "";

                // 3. Obtener el texto del textarea
                const descripcionText = descripcionEl.value;

                // 4. Combinar los textos
                const finalText = baseContent + descripcionText;

                // 5. Copiar al portapapeles
                copyToClipboard(finalText);
            });

            // Iniciar la carga de tooltips cuando la página esté lista
            loadTooltipsAndContent();
        });
    </script>
</body>
</html>
