<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Texto</title>
    <!-- Cargamos Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Usamos la fuente Inter como se recomienda */
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- Corregido a max-w-7xl (con 'l' en lugar de '1') para un ancho máximo válido de Tailwind -->
    <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-7xl">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">Generador de Descripciones</h1>

        <!-- Desplegable de Constitución -->
        <div class="mb-6">
            <label for="constitucion" class="block text-lg font-semibold text-gray-700 mb-2">
                Constitución Corporal
            </label>
            <select id="constitucion" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white">
                <option value="" selected disabled>Selecciona una...</option>
                <option value="Delgada (fitness)">1: Delgada (fitness)</option>
                <option value="Delgada (musculosa)">2: Delgada (musculosa)</option>
                <option value="Delgada (anoréxica)">3: Delgada (anoréxica)</option>
                <option value="Rellenita">4: Rellenita</option>
                <option value="Gordita">5: Gordita</option>
                <option value="Caderas Anchas">6: Caderas Anchas</option>
            </select>
        </div>

        <!-- Desplegable de Pechos -->
        <div class="mb-6">
            <label for="pechos" class="block text-lg font-semibold text-gray-700 mb-2">
                Pechos
            </label>
            <select id="pechos" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white">
                <option value="" selected disabled>Selecciona una...</option>
                <option value="Pechos medianos">1: Pechos medianos</option>
                <option value="Pechos muy muy pequeños y planos">2: Pechos muy muy pequeños y planos</option>
                <option value="Pechos grandes y juntos">3: Pechos grandes y juntos</option>
                <option value="Pechos muy muy grandes">4: Pechos muy muy grandes</option>
            </select>
        </div>

        <!-- Desplegable de camara -->
        <div class="mb-6">
            <label for="camara" class="block text-lg font-semibold text-gray-700 mb-2">
                Cámara
            </label>
            <select id="camara" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition bg-white">
                <option value="" selected disabled>Selecciona una...</option>
                <option value="La cámara permanece estática">1: La cámara permanece estática</option>
                <option value="La cámara se aleja">2: La cámara se aleja</option>
                <option value="La cámara se acerca">3: La cámara se acerca</option>
                <option value="La cámara se acerca con detalle">4: La cámara se acerca con detalle</option>
            </select>
        </div>
        
        <!-- Área de Texto -->
        <div class="mb-6">
            <label for="descripcion" class="block text-lg font-semibold text-gray-700 mb-2">
                Descripción de la persona
            </label>
            <textarea
                id="descripcion"
                rows="6"
                class="w-full p-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                placeholder="Escribe aquí los detalles..."
            ></textarea>
        </div>

        <!-- Checkbox Cuerpo Natural -->
        <div class="mb-4">
            <label for="cuerpoNatural" class="flex items-center cursor-pointer w-max">
                <input type="checkbox" id="cuerpoNatural" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" checked>
                <span class="ml-3 text-md font-medium text-gray-800">Cuerpo Natural</span>
            </label>
        </div>

        <!-- Opciones de Radio -->
        <div class="mb-8">
            <!-- Título del grupo cambiado a "BASE" -->
            <label class="block text-lg font-semibold text-gray-700 mb-3">BASE</label>
            <div class="space-y-3">
                <!-- Opción 1 (marcada por defecto) -->
                <!-- El atributo 'title' se rellenará con JavaScript -->
                <label for="opt-1" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer" title="Cargando...">
                    <input type="radio" id="opt-1" name="base_option" value="1" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300" checked>
                    <span class="ml-3 text-md font-medium text-gray-800">Base 1</span>
                </label>

                <!-- Opción 2 -->
                <label for="opt-2" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer" title="Cargando...">
                    <input type="radio" id="opt-2" name="base_option" value="2" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300">
                    <span class="ml-3 text-md font-medium text-gray-800">Base 2</span>
                </label>

                <!-- Opción 3 -->
                <label for="opt-3" class="flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition cursor-pointer" title="Cargando...">
                    <input type="radio" id="opt-3" name="base_option" value="3" class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300">
                    <span class="ml-3 text-md font-medium text-gray-800">Base 3</span>
                </label>
            </div>
        </div>

        <!-- Botón de Generar -->
        <button id="generarBtn" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:bg-blue-700 transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
            Generar y Copiar
        </button>

        <!-- Mensaje de confirmación (en lugar de alert) -->
        <div id="messageBox" class="mt-6 p-4 bg-green-100 text-green-800 rounded-lg text-center font-medium hidden transition-all duration-300">
            ¡Texto copiado al portapapeles!
        </div>
    </div>

    <script>
        // SCRIPT COMPLETO Y CORREGIDO
        window.addEventListener('DOMContentLoaded', () => {
            const descripcionEl = document.getElementById('descripcion');
            const constitucionEl = document.getElementById('constitucion');
            const pechosEl = document.getElementById('pechos');
            const camaraEl = document.getElementById('camara');
            const cuerpoNaturalEl = document.getElementById('cuerpoNatural'); 
            const generarBtn = document.getElementById('generarBtn');
            const messageBox = document.getElementById('messageBox');

            // Objeto para almacenar el contenido de los archivos
            const fileContents = {};

            // Función para mostrar mensajes
            function showMessage(text, isError = false) {
                messageBox.textContent = text;
                messageBox.classList.remove('hidden');
                if (isError) {
                    messageBox.classList.remove('bg-green-100', 'text-green-800');
                    messageBox.classList.add('bg-red-100', 'text-red-800');
                } else {
                    messageBox.classList.remove('bg-red-100', 'text-red-800');
                    messageBox.classList.add('bg-green-100', 'text-green-800');
                }
                // Ocultar mensaje después de 3 segundos, excepto si es de carga
                if (!text.includes('Cargando')) {
                    setTimeout(() => {
                        messageBox.classList.add('hidden');
                    }, 3000);
                }
            }

            // --- FUNCIÓN DE CARGA DE TOOLTIPS ---
            async function loadTooltipsAndContent() {
                // URL Hardcoded
                const baseUrl = "https://raw.githubusercontent.com/elmaestromutenroy/grok_promts/master/base/";

                const options = [
                    { value: '1', labelFor: 'opt-1' },
                    { value: '2', labelFor: 'opt-2' },
                    { value: '3', labelFor: 'opt-3' }
                ];

                let allLoaded = true;

                // Mostrar estado de carga y deshabilitar botón
                showMessage('Cargando archivos base...', false);
                generarBtn.disabled = true;
                generarBtn.textContent = 'Cargando...';
                generarBtn.classList.add('opacity-50', 'cursor-not-allowed');

                // Usamos Promise.all para cargar todos los archivos en paralelo
                await Promise.all(options.map(async (opt) => {
                    // Construimos la URL completa
                    const fileName = `${baseUrl}${opt.value}.txt`; 
                                                                        
                    const label = document.querySelector(`label[for="${opt.labelFor}"]`);
                    
                    try {
                        // Añadimos 'cache: "no-store"' para evitar problemas de caché
                        const response = await fetch(fileName, { cache: "no-store" }); 
                        if (!response.ok) {
                            throw new Error(`Error ${response.status} al cargar ${fileName}`);
                        }
                        const text = await response.text();
                        
                        fileContents[opt.value] = text; 
                        
                        if (label) {
                            label.title = text;
                        }
                        
                    } catch (err) {
                        console.error(err.message);
                        allLoaded = false;
                        if (label) {
                            label.title = `Error al cargar: ${err.message}`;
                        }
                        fileContents[opt.value] = `[Error al cargar ${opt.value}.txt]`; 
                    }
                }));

                // Actualizar UI después de la carga
                if (allLoaded) {
                    showMessage('¡Archivos cargados! Listo.', false);
                    generarBtn.disabled = false;
                    generarBtn.textContent = 'Generar y Copiar';
                    generarBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    showMessage('Error al cargar archivos. Revisa la consola.', true);
                    generarBtn.textContent = 'Error de carga';
                    // El botón permanece deshabilitado
                }

                return allLoaded;
            }
            // --- FIN DE CARGA DE TOOLTIPS ---

            // --- Event listener para el desplegable Constitución ---
            constitucionEl.addEventListener('change', () => {
                const selectedText = constitucionEl.value;
                if (selectedText) { // Nos aseguramos de que no sea la opción "Selecciona una..."
                    descripcionEl.value += `Constitución corporal ${selectedText}. `;
                }
            });

            // --- Event listener para el desplegable Pechos ---
            pechosEl.addEventListener('change', () => {
                const selectedText = pechosEl.value;
                if (selectedText) { // Nos aseguramos de que no sea la opción "Selecciona una..."
                    descripcionEl.value += `Tiene ${selectedText}. `;
                }
            });

            // --- Event listener para el desplegable camara ---
            // CORREGIDO: Ahora escucha a 'camaraEl', no a 'pechosEl'
            camaraEl.addEventListener('change', () => {
                const selectedText = camaraEl.value;
                if (selectedText) { // Nos aseguramos de que no sea la opción "Selecciona una..."
                    descripcionEl.value += `${selectedText}. `;
                }
            });
            
            // --- Función para copiar al portapapeles ---
            function copyToClipboard(text) {
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = text;
                tempTextarea.style.position = 'absolute';
                tempTextarea.style.left = '-9999px'; // Ocultarlo
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                try {
                    document.execCommand('copy');
                    showMessage('¡Texto combinado copiado al portapapeles!', false);
                } catch (err) {
                    console.error('Error al copiar al portapapeles: ', err);
                    showMessage('Error al copiar. Revisa la consola.', true);
                }
                document.body.removeChild(tempTextarea);
            }

            // --- Evento click del botón "Generar y Copiar" ---
            generarBtn.addEventListener('click', () => {
                // 1. Obtener la opción seleccionada
                const selectedOption = document.querySelector('input[name="base_option"]:checked');
                if (!selectedOption) {
                    showMessage('Por favor, selecciona una opción BASE.', true);
                    return;
                }
                
                const selectedValue = selectedOption.value;

                // 2. Obtener el contenido base
                const baseContent = fileContents[selectedValue] ? fileContents[selectedValue] + " " : "";

                // 3. Obtener el texto del textarea
                const descripcionText = descripcionEl.value;

                // 4. Combinar los textos
                let finalText = baseContent + descripcionText; // <-- Cambiado a let

                // 5. AÑADIR TEXTO DEL CHECKBOX
                if (cuerpoNaturalEl.checked) {
                    finalText += " Su cuerpo tiene pecas e imperfecciones. ";
                }

                // 6. Copiar al portapapeles
                copyToClipboard(finalText);
            });

            // Llamamos a la función de carga al iniciar 
            loadTooltipsAndContent();
            
        }); 
    </script>
</body>
</html>
